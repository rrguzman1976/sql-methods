USE ScratchDB;
GO
/*
DROP TABLE IF EXISTS #P;

CREATE TABLE #P
(
	PROJ_ID INT IDENTITY(1, 1)
	, PROJ_START DATE
	, PROJ_END DATE
);

INSERT INTO #P
VALUES ('01-JAN-2005', '02-JAN-2005')
		, ('02-JAN-2005', '03-JAN-2005')
		, ('03-JAN-2005', '04-JAN-2005')
		, ('04-JAN-2005', '05-JAN-2005')
		, ('06-JAN-2005', '07-JAN-2005')
		, ('16-JAN-2005', '17-JAN-2005')
		, ('17-JAN-2005', '18-JAN-2005')
		, ('18-JAN-2005', '19-JAN-2005')
		, ('19-JAN-2005', '20-JAN-2005')
		, ('21-JAN-2005', '22-JAN-2005')
		, ('26-JAN-2005', '27-JAN-2005')
		, ('27-JAN-2005', '28-JAN-2005')
		, ('28-JAN-2005', '29-JAN-2005')
		, ('29-JAN-2005', '30-JAN-2005')
;
--*/

SELECT	*
FROM	(
	SELECT	*
			, LEAD(PROJ_START, 1, NULL) OVER (ORDER BY PROJ_START) AS FWD1
	FROM	#P
) AS x
WHERE	PROJ_END = FWD1
ORDER BY PROJ_START;

-- Without window function
SELECT	*
FROM	#P AS p
	CROSS JOIN #P AS p2
WHERE	p.PROJ_END = p2.PROJ_START
ORDER BY p.PROJ_START

SELECT	@@TRANCOUNT, XACT_STATE();